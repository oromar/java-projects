<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- 
 Em : 04/07/2015 - 00:56:17
-->

<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
	template="./Menu.xhtml" xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core">

	<ui:define name="Conteudo">

		<h:panelGrid style="margin-left:10px;width:70%">

			<h1>Listagem de Livro</h1>
			<br />
			<br />

			<h:form id="form_"
				styleClass="form-horizontal">

				<p:growl showDetail="true" autoUpdate="true" globalOnly="true" />

				<h:commandButton type="button" styleClass="btn btn-primary"
					value="Novo" immediate="true">
					<p:ajax event="click"
						oncomplete="dialogCadastroLivro.show();"
						listener="#{livroMB.novoListener}" process="@this"
						update=":form_cadastro" />
				</h:commandButton>

				<h:panelGrid style="float:right;" columns="5" id="panel_filter">

					<h:inputText id="input__filter_nome_livro"
						style="float:right;width:200%;" styleClass="form-control"
						value="#{livroMB.filterValue}">
						<f:ajax event="keyup" execute="@this"
							listener="#{livroMB.filterDataTable}"
							render="table_" />
					</h:inputText>
					
							&nbsp;&nbsp;
							
						<h:commandButton style="float:right;" styleClass="btn btn-primary"
						type="button"
						onclick="dialog.show();"
						value="Pesquisar" immediate="true" />
						
						&nbsp;&nbsp;
						
					<h:commandButton style="float:right;" styleClass="btn btn-primary"
						type="button" value="Limpar Filtro" immediate="true">
						<p:ajax listener="#{livroMB.clearFilterListener}" process="@this"
							update=":form_:table_, :form_busca_" />
					</h:commandButton>

				</h:panelGrid>

				<br />
				<br />

				<h:dataTable id="table_"
					value="#{livroMB.listaBeans}"
					styleClass="table table-bordered table-hover"
					var="livro"
					style="width:100%;cellspacing:10; cellpadding:10;">

					<h:column id="column_id_livro">
						<f:facet name="header">
							<h:outputLabel value="#" />
						</f:facet>
						<h:outputLabel value="#{livro.id}" />
					</h:column>

					<h:column id="column_nome_livro">
						<f:facet name="header">
							<h:outputLabel value="Nome" />
						</f:facet>
						<h:outputLabel value="#{livro.nome}" />
					</h:column>

					<h:column id="column_testamento_livro">
						<f:facet name="header">
							<h:outputLabel value="Testamento"/>
						</f:facet>
						<h:outputLabel value="#{livro.testamento}"/>
					</h:column>

					<h:column id="column_posicao_livro">
						<f:facet name="header">
							<h:outputLabel value="Posicao"/>
						</f:facet>
						<h:outputLabel value="#{livro.posicao}"/>
					</h:column>



					<h:column>
						<f:facet name="header">
							<h:outputLabel value="Ação" />
						</f:facet>
						<h:commandLink>
							<span class="glyphicon glyphicon-pencil" />
							<p:ajax event="click" listener="#{livroMB.updateListener}"
								process="@this" oncomplete="dialogCadastroLivro.show();"
								update=":form_cadastro" />
							<f:attribute name="beanToUpdate"
								value="#{livro}" />
						</h:commandLink>
						
						&nbsp;&nbsp;
						
						<h:commandLink immediate="true">
							<span class="glyphicon glyphicon-remove" />
							<p:ajax event="click" listener="#{livroMB.removeListener}"
								update=":form_" process="@this" />
							<f:attribute name="beanToRemove"
								value="#{livro}" />
						</h:commandLink>
					</h:column>
				</h:dataTable>
			</h:form>
		</h:panelGrid>

		<p:dialog id="dialog_busca_avancada_"
			styleClass="panel panel-primary"
			widgetVar="dialog" modal="true"
			showEffect="fade" showHeader="true" width="800" hideEffect="fade"
			resizable="false">

			<f:facet name="header">
				<h:outputLabel value="Pesquisa de Livro" />
			</f:facet>

			<h:form id="form_busca_"
				styleClass="form-horizontal">

				<h:panelGrid styleClass="form-group" style="margin-left:10px;">

					<h:outputLabel value="Nome" />
					<h:inputText value="#{livroMB.beanFiltro.nome}"
						styleClass="form-control" size="80" />
						
					<h:outputLabel value="Testamento" /> 
					<h:inputText id="input_filtro_testamento_livro" value="#{livroMB.beanFiltro.testamento}" styleClass="form-control"/>

					<h:outputLabel value="Posicao" /> 
					<h:inputText id="input_filtro_posicao_livro" value="#{livroMB.beanFiltro.posicao}" styleClass="form-control"/>



				</h:panelGrid>
				<br />

				<h:panelGrid columns="4" style="float:right;">

					<h:commandButton styleClass="btn btn-primary" value="Pesquisar">
						<p:ajax event="click" listener="#{livroMB.filterDataTable}"
							update="@form, :form_:table_"
							process="@form"
							oncomplete="dialog.hide();" />
					</h:commandButton>

					<br />

					<h:commandButton type="button" styleClass="btn btn-primary"
						value="Cancelar"
						onclick="dialog.hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>

		<p:dialog id="dialogCadastroLivro_"
			styleClass="panel panel-default"
			widgetVar="dialogCadastroLivro" modal="true"
			showEffect="fade" showHeader="true" width="800" resizable="false"
			hideEffect="fade">

			<f:facet name="header" widgetVar="dialogCadastroLivro">
				<h:outputLabel value="Cadastro de Livro" />
			</f:facet>

			<h:form id="form_cadastro" styleClass="form-horizontal">

				<h:panelGrid styleClass="form-group"
					style="width:80%;margin-left:10px;">

					<h:outputLabel value="Nome" />
					<h:inputText id="input_nome_livro" styleClass="form-control" value="#{livroMB.beanSelecionado.nome}" />

					<h:outputLabel value="Testamento" /> 
					<h:inputText id="input_testamento_livro" value="#{livroMB.beanSelecionado.testamento}" styleClass="form-control"/>

					<h:outputLabel value="Posicao" /> 
					<h:inputText id="input_posicao_livro" value="#{livroMB.beanSelecionado.posicao}" styleClass="form-control"/>



				</h:panelGrid>

				<br />

				<h:panelGrid columns="5">

					<h:commandButton styleClass="btn btn-primary" value="Salvar">
						<p:ajax event="click" listener="#{livroMB.saveListener}"
							update=":form_, :form_cadastro"
							process="@form" />
						<f:attribute name="beanToSave" value="#{livroMB.beanSelecionado}" />
					</h:commandButton>
					
						&nbsp;&nbsp;
						
						<h:commandButton id="btn_limpar" styleClass="btn btn-primary"
						value="Limpar">
						<f:ajax event="click" listener="#{livroMB.limparListener}"
							render="@form" execute="@this" immediate="true" />
					</h:commandButton>
					
						&nbsp;&nbsp;
						
							<h:commandButton styleClass="btn btn-primary" value="Cancelar"
						type="button" onclick="dialogCadastroLivro.hide();">
					</h:commandButton>

				</h:panelGrid>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>
